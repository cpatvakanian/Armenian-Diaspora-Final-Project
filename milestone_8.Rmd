---
title: "milestone_8"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE)

library(httr)
library(knitr)
library(dplyr)
library(glue)
library(readxl)
library(janitor)
library(reprex)
library(readxl)
library(lubridate)
library(anytime)
library(moderndive)
library(gt)
library(maps)
library(purrr)
library(tibble)
library(forcats)
library(infer)
library(fs)
library(devtools)
library(rworldmap)
library(googlesheets4)
library(infer)
library(ggplot2)
library(scales)
library(tidyverse)
```

## R Markdown

This is an R Markdown document. Markdown is a simple formatting syntax for authoring HTML, PDF, and MS Word documents. For more details on using R Markdown see <http://rmarkdown.rstudio.com>.

When you click the **Knit** button a document will be generated that includes both content as well as the output of any embedded R code chunks within the document. You can embed an R code chunk like this:

```{r Setting up Data, warning = FALSE}

# data is from wikipedia website:

diasporas <- read_csv(file = 'Diaspora_Data.csv') %>%
  slice(2:68) %>%
  select(`Area[n 1]`, `Country`, `Official data/Estimates`, `Communities`) %>%
  group_by("Country")

# Data is from embassies website: https://www.embassypages.com/armenia

embassies <- read_csv(file = 'embassies.csv')

# Merged data of communities, embassies, top google trends

all_data_merged <- read_csv(file = "all_data.csv") %>%
  slice(1:26)

# Regression of data, but this is very
# tricky to try and visualize because
# the x variables are both continous
# and binary and the y is continuous
# so I'd have to hold some things constant
# I am not quite sure what's the best way to
# visualize this

regression <- lm(Number_Comm ~ TopTen_Gen + TopTen_Dux + Number_Comm + Embassies + Population + Post_Soviet, data = all_data_merged)
summary(regression)


graph_regression <- ggplot(regression, aes(x= Number_Comm, y = overall)) +
  geom_point( alpha = 0.5) +
  facet_grid(. ~ divisional_distribution, labeller=labeller(divisional_distribution = labels)) +
  geom_smooth(method = "lm", se = FALSE) +
  labs(title = "Student Reported Workloads and Course Evaluations at Harvard", subtitle = "Relationship Varies Across Academic Divisions", caption= "Data From Spring 2019 Courtesy of Benny Chang '22",
       x = "Average Workload in Hours per Week", y = "Average Student Evaluations")
  
question5_graph




```


```{r MapGraphic}

d <- data.frame(
  country=c("Argentina", "Brazil", "Bulgaria", "Canada", "Egypt",
             "France", "Georgia", "Germany", "Greece","Iran",
            "Iraq", "Kazakhstan", "Lebanon", "Russia", "Sweden","Syria", "Turkmenistan", "Ukraine", "United Kingdom",
           "United States", "Turkey", "Uzbekistan", "Uruguay", "Australia", "Switzerland", "Israel"),
  value=c(2, 2, 2, 2, 2,2, 2, 2, 1, 2, -2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2))

n <- joinCountryData2Map(d, joinCode="NAME", nameJoinColumn="country")

mapCountryData(n, nameColumnToPlot="value", mapTitle="World",
  mapRegion = "World",
  colourPalette="terrain",
  addLegend=FALSE,
  oceanCol="lightblue", missingCountryCol="white")

mapCountryData(n, nameColumnToPlot="value", mapTitle="Eurasia",
  mapRegion = "Eurasia",
  colourPalette="terrain",
  addLegend=FALSE,
  oceanCol="lightblue", missingCountryCol="white")

mapCountryData(n, nameColumnToPlot="value", mapTitle="South America",
  mapRegion = "Latin America",
  colourPalette="terrain",
  addLegend=FALSE,
  oceanCol="lightblue", missingCountryCol="white")

```



