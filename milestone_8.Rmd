---
title: "milestone_8"
output: html_document
---

```{r setup, include=FALSE, warnings= FALSE}
knitr::opts_chunk$set(echo = FALSE)

library(httr)
library(knitr)
library(dplyr)
library(glue)
library(readxl)
library(janitor)
library(reprex)
library(readxl)
library(lubridate)
library(anytime)
library(moderndive)
library(gt)
library(maps)
library(png)
library(purrr)
library(tibble)
library(forcats)
library(infer)
library(fs)
library(devtools)
library(rworldmap)
library(googlesheets4)
library(infer)
library(ggplot2)
library(scales)
library(tidyverse)
```

## R Markdown

This is an R Markdown document. Markdown is a simple formatting syntax for authoring HTML, PDF, and MS Word documents. For more details on using R Markdown see <http://rmarkdown.rstudio.com>.

When you click the **Knit** button a document will be generated that includes both content as well as the output of any embedded R code chunks within the document. You can embed an R code chunk like this:

```{r Setting up Data, warning = FALSE}

# data is from wikipedia website:

diasporas <- read_csv(file = 'Diaspora_Data.csv') %>%
  slice(2:68) %>%
  select(`Area[n 1]`, `Country`, `Official data/Estimates`, `Communities`) %>%
  group_by("Country")

# Data is from embassies website: https://www.embassypages.com/armenia

embassies <- read_csv(file = 'embassies.csv')

# Merged data of communities, embassies, top google trends

all_data_merged <- read_csv(file = "all_data.csv") %>%
  slice(1:26)







```


```{r MapGraphic 1}

d <- data.frame(
  country=c("Argentina", "Brazil", "Bulgaria", "Canada", "Egypt",
             "France", "Georgia", "Germany", "Greece","Iran",
            "Iraq", "Kazakhstan", "Lebanon", "Russia", "Sweden","Syria", "Turkmenistan", "Ukraine", "United Kingdom",
           "United States", "Turkey", "Uzbekistan", "Uruguay", "Australia", "Switzerland", "Israel"),
  value=c(2, 2, 2, 2, 2,2, 2, 2, 1, 2, -2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2))

n <- joinCountryData2Map(d, joinCode="NAME", nameJoinColumn="country")

png("diaspora_final_project/world_map.png",width=800,height=600,units="px")
world <- mapCountryData(n, nameColumnToPlot="value", mapTitle="Overview of Armenian Diaspora Communities in the World",
  mapRegion = "World",
  colourPalette="Red",
  addLegend=FALSE,
  oceanCol="lightblue", missingCountryCol="white")

```

```{r MapGraphic2}


png("diaspora_final_project/eurasia_map.png",width=800,height=600,units="px")
eurasia <- mapCountryData(n, nameColumnToPlot="value", mapTitle="Overview of Armenian Diaspora Communities in Eurasia",
  mapRegion = "Eurasia",
  colourPalette="Red",
  addLegend=FALSE,
  oceanCol="lightblue", missingCountryCol="white")

```

```{r MapGraphic3}


png("diaspora_final_project/latin_map.png",width=800,height=600,units="px")
latin <- mapCountryData(n, mapTitle="Overview of Armenian Diaspora Communities in South America", nameColumnToPlot="value", 
  mapRegion = "Latin America",
  colourPalette="Red",
  addLegend=FALSE,
  oceanCol="lightblue", missingCountryCol="white")

```



```{r histogram}

all_data_merged %>% mutate_if(is.character,as.integer)

all_data_merged$Number_Comm <- as.integer(all_data_merged$Number_Comm)

data_histogram <- all_data_merged %>%
  select(Population,Number_Comm)

histo.df <- as.data.frame(data_histogram)

write_rds(histo.df, "diaspora_final_project/histo.rds")


```






```{r Diaspora Data Highlights}

# here I am specifing countries which
# have diasporas from the times of 
# Armenian genocide immigrants fleeing
# from Western Armenia in 1915

d3 <- data.frame(
  country=c("Argentina", "Canada",
             "France", "Georgia", "Greece",
             "Lebanon", "Russia", "Syria", "Ukraine", 
           "United States", "Turkey",  "Uruguay", "Australia", "Israel"),
  value=c(2, 2, 2, 2, 2, 2, 2, 2, -2, 2, 2, 2, 2, 2))

n3 <- joinCountryData2Map(d3, joinCode="NAME", nameJoinColumn="country")

png("diaspora_final_project/diasporasgenocide.png",width=800,height=600,units="px")
mapCountryData(n3, nameColumnToPlot="value", mapTitle="Diasporas from Armenian Genocide",
  mapRegion = "World",
  colourPalette="negpos8",
  addLegend=FALSE,
  oceanCol="lightblue", missingCountryCol="white",
  lwd = 0.7)

# This map here is showing us
# the diasporas which exist after
# the USSR collapsed and typically
# attributing to existing bc of the
# soviet union

d4 <- data.frame(
  country=c("Bulgaria", "Canada","Brazil",
             "France", "Georgia", "Germany", "Greece",
            "Kazakhstan", "Russia", "Turkmenistan", "Ukraine",
           "United States", "Uzbekistan"),
  value=c(2, 2, 2, 2, 2, 2, 2, 2, -2, 2, 2, 2,2))

n4 <- joinCountryData2Map(d4, joinCode="NAME", nameJoinColumn="country")

png("diaspora_final_project/postsoviet.png",width=800,height=600,units="px")
mapCountryData(n4, nameColumnToPlot="value", mapTitle="Post Soviet Diasporas",
  mapRegion = "World",
  colourPalette="white2black",
  addLegend=FALSE,
  oceanCol="lightblue", missingCountryCol="white",
  lwd = 0.7)

# These are Diasporas which exist
# for very specific historic reasons
# and also reasons which realy have
# no particular special explanation other
# other than migration for economic

d5 <- data.frame(
  country=c( "Egypt",
            "Iran",
            "Iraq", "Sweden","Syria","United Kingdom", "Germany",
            "Switzerland", "Israel"),
  value=c(2, 2, 2, 2, 2, 2, -2, 2,2))

n5 <- joinCountryData2Map(d5, joinCode="NAME", nameJoinColumn="country")

png("diaspora_final_project/historic.png",width=800,height=600,units="px")
mapCountryData(n5, nameColumnToPlot="value", mapTitle="Historic or Random Diasporas",
  mapRegion = "Eurasia",
  colourPalette="palette",
  addLegend=FALSE,
  oceanCol="lightblue", missingCountryCol="white",
  lwd = 0.7)



```

```{r What Influences Number of Communities}

# Regression of data, but this is very
# tricky to try and visualize because
# the x variables are both continous
# and binary and the y is continuous
# so I'd have to hold some things constant
# I am not quite sure what's the best way to
# visualize this

#regression <- lm(Number_Comm ~ TopTen_Gen + TopTen_Dux + Number_Comm + Embassies + Population + Post_Soviet, data = all_data_merged)
#summary(regression)

regression_for_graph <- lm(Number_Comm ~ Population + Post_Soviet, data = all_data_merged)

png("diaspora_final_project/regression.png",width=800,height=600,units="px")
regression_graph <- ggplot(regression_for_graph, aes(x= Population, y = Number_Comm)) +
  geom_point( alpha = 0.5) +
  geom_smooth(method = "lm", se = FALSE) +
  labs(title = "Population vs Number of Communities", subtitle = "Relationship Looks Positive", caption= "Wikipedia",
       x = "Population Numbers (Official & Estimates)", y = "Number of Communities in a Country")
  

regression_graph

```


```{r About}

# have this completed from previous one
```
## About the Armenian Diaspora Data Project
This project is trying to better understand the trends and characteristics of the Armenian Diaspora communities which exist all over the world. Armenian Diaspora communities have existed for hundreds of years, but the primary large communities that scattered and exist today come from two major events in Armenian history. The first event was the Armenian Genocide of 1915, during which 1.5 Armenians and many other Christian minorities such as the Assyrians and Greeks were killed due to the genocidal campaign of the Ottoman Turkish government. The result of the genocide was the mass exodus of Armenians to countries such as Syria, France, Lebanon, Russia, the United States, Australia and even Argentina. The second major event which explains the diaspora communities of that exist in other parts of the world was the collapse of the USSR and subsequent socio-economic crisis, after which many Armenians immigrated to the United States, Russia, and various other countries. Of course, there also exist other older, but much smaller communities in Jerusalem and India - which have ties back to ancient Armenian religious ties and trade expeditions.

## Data on the Diaspora
Finding data on the Armenian Diaspora is notoriously difficult, but Wikipedia and Google trends are able to capture a rough idea of where Armenians are generally located. By looking at compilations of various sources on Wikipedia's Armenian Diaspora Communities page (https://en.wikipedia.org/wiki/Largest_Armenian_diaspora_communities), I am able to confirm for a variety of countries the number of communities and also the populations of those communities. Additionally, by looking at data on the Google Trends Website (https://trends.google.com/trends/?geo=US), I am able to look at these countries and try to look at trends or key words for Armenians that I think might confirm the census data. Interestingly, there are different and similar trends for Armenians depending on which community we are looking at (old vs newly formed).

## About the Author
I am a senior at Harvard College studying Economics with a minor in Government.


